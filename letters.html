<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Letter</title>
  <style>
    body{display:flex;align-items:center;justify-content:center;height:100vh;margin:0;background-image:url('hato2.png');background-attachment:fixed;background-size:cover;background-position:center;font-family:system-ui,Segoe UI,Roboto,Helvetica,Arial}
    /* make the envelope area take most of the page */
    .scene{width:92vw;max-width:980px;text-align:center;padding:18px}
    .envelope{width:100%;height:auto;display:block;margin:0 auto;cursor:pointer;transition:transform .3s ease}
    .flap{transform-origin:50% 0;transition:transform .6s cubic-bezier(.2,.8,.2,1)}
    .envelope.open .flap{transform:rotateX(-180deg)}
    .letter{position:relative;top:-40%;opacity:0;transform:translateY(10px);transition:all .6s .25s cubic-bezier(.2,.8,.2,1);background:#fff;padding:24px;border-radius:6px;box-shadow:0 8px 30px rgba(20,30,60,.12)}
    .scene.open .letter{top:0;opacity:1;transform:none}
    .cta{margin-top:18px;color:#3b82f6}
    .back-button{display:inline-block;margin-top:20px;padding:8px 14px;background:#111827;color:#fff;border-radius:6px;text-decoration:none}
  </style>
</head>
<body>
  <!-- Use same audio element so music continues playing -->
  <audio id="bgMusic" style="display:none" autoplay loop>
    <source src="music.mp3" type="audio/mpeg">
  </audio>
  <div class="scene">
    <!-- Envelope image (env.png) with clickable seal -->
    <div style="position:relative;width:360px;margin:0 auto;background:#f3f6fb;border-radius:8px;overflow:hidden">
      <img id="envelope" class="envelope" src="env.png" alt="Envelope" style="width:100%;height:auto;display:block;cursor:pointer;opacity:1" onerror="this.style.background='#e6eefc';this.style.display='none'" />
      <!-- Fallback envelope SVG if image is missing -->
      <svg id="envelopeFallback" class="envelope" viewBox="0 0 360 240" xmlns="http://www.w3.org/2000/svg" style="display:none;width:100%;height:auto" aria-label="Envelope">
        <defs>
          <linearGradient id="g" x1="0" x2="1">
            <stop offset="0" stop-color="#e6eefc"/>
            <stop offset="1" stop-color="#d7e8ff"/>
          </linearGradient>
        </defs>
        <rect x="10" y="40" width="340" height="160" rx="8" fill="url(#g)" stroke="#c7ddff"/>
        <path class="flap" d="M10 40 L180 120 L350 40 Z" fill="#cfe4ff" stroke="#bcd8ff"/>
      </svg>
      <!-- Visible clickable seal (load from seal.png) -->
      <img id="seal-group" src="seal.png" alt="Seal" style="position:absolute;left:50%;top:30%;transform:translate(-50%,-50%);width:70px;height:70px;cursor:pointer;pointer-events:all;border-radius:50%;box-shadow:0 4px 12px rgba(0,0,0,0.3);transition:transform 0.1s ease;object-fit:cover" title="Click to open" />
    </div>

    <a href="index.html" class="back-button">← Back to Maze</a>
  </div>

  <!-- Full-page overlay that will display the letter content when the seal is clicked (full-screen takeover) -->
  <div id="overlay" aria-hidden="true" style="position:fixed;inset:0;display:none;align-items:stretch;justify-content:flex-start;background:rgba(6,11,22,0.85);z-index:1200">
    <div role="dialog" aria-modal="true" style="width:100%;height:100%;background:#fff;padding:48px;box-sizing:border-box;position:relative;overflow:auto">
      <button id="closeOverlay" aria-label="Close letter" style="position:absolute;right:18px;top:18px;border:none;background:transparent;color:#374151;font-size:26px;cursor:pointer">✕</button>
      <section id="fullLetter" style="max-width:1100px;margin:28px auto;color:#0b1220">
        <article style="max-width:900px;margin:40px auto;font-size:22px;line-height:1.8;color:#0b1220;padding:6px">
          <h1 style="font-size:48px;margin:0 0 14px 0;letter-spacing:0.6px">Happy Valentine's Day</h1>

          <p>Happy Valentine's day once more baby. Thaank you for the gifts, i'll wait for you to come back to me so you can be the kelinci percobaan me masak lagi anjay.</p>

          <p>May this 3rd Valentine be another reminder of how far we've come (ini kenapa puitis banget dah), may we still be together till the 1238029819301th Valentine's together ohohoho!</p>

          <p>Thank you for always trying your best to be the best boyfriend, I genuinely appreciate you for it even if sometimes ga keliatan ya? I'll try my best to lessen down the jabs on you kalau kita argue, i want it to be Us vs the problem and not You vs Me :"[ hayayaa yaa pada intinya semoga kita berdua selalu come back to each other,</p>

          <p style="margin-top:20px;font-weight:700;font-size:20px">I love you lots, and I will always do.</p>
        </article>
      </section>
    </div>
  </div>

  <script>
    const env = document.getElementById('envelope');
    const envelopeFallback = document.getElementById('envelopeFallback');
    const sealGroup = document.getElementById('seal-group');
    const scene = document.querySelector('.scene');
    const overlay = document.getElementById('overlay');
    const closeOverlay = document.getElementById('closeOverlay');

    // Show fallback if env.png is missing
    env.addEventListener('error', ()=>{
      env.style.display = 'none';
      if (envelopeFallback) envelopeFallback.style.display = 'block';
    });

    function showOverlay() {
      overlay.style.display = 'flex';
      overlay.setAttribute('aria-hidden', 'false');
      // small entry animation
      overlay.firstElementChild.style.transform = 'translateY(8px)';
      overlay.firstElementChild.style.opacity = '0';
      requestAnimationFrame(()=>{
        overlay.firstElementChild.style.transition = 'transform .36s cubic-bezier(.2,.8,.2,1), opacity .36s ease';
        overlay.firstElementChild.style.transform = 'translateY(0)';
        overlay.firstElementChild.style.opacity = '1';
      });
      // set focus for accessibility
      closeOverlay.focus();
    }

    function hideOverlay() {
      overlay.firstElementChild.style.transform = 'translateY(8px)';
      overlay.firstElementChild.style.opacity = '0';
      setTimeout(()=>{
        overlay.style.display = 'none';
        overlay.setAttribute('aria-hidden', 'true');
      }, 360);
    }

    // Seal click opens the full-page overlay
    function onSealClick(e){
      if(e && e.preventDefault) e.preventDefault();
      if(e && e.stopPropagation) e.stopPropagation();
      // small envelope open animation for context
      scene.classList.add('open');
      setTimeout(showOverlay, 200);
    }

    // Attach seal click handler
    if (sealGroup) {
      sealGroup.addEventListener('click', onSealClick);
      sealGroup.addEventListener('keypress', (e)=>{ if(e.key==='Enter' || e.key===' ') onSealClick(e); });
      sealGroup.setAttribute('role','button');
      sealGroup.setAttribute('tabindex','0');
    }

    // Allow clicking the envelope body also
    if (env) {
      env.addEventListener('click', ()=>{
        if (!scene.classList.contains('open')) {
          onSealClick();
        }
      });
    }

    // Close overlay handlers
    closeOverlay.addEventListener('click', hideOverlay);
    overlay.addEventListener('click', (e)=>{ if (e.target === overlay) hideOverlay(); });
    document.addEventListener('keydown', (e)=>{ if (e.key === 'Escape') hideOverlay(); });

    // Sync audio with maze page if music is playing there
    window.addEventListener('pageshow', ()=>{
      const audioEl = document.getElementById('bgMusic');
      if (audioEl && audioEl.paused) {
        audioEl.play().catch(err => console.log('Could not resume audio'));
      }
    });

    // Add visual feedback on seal hover
    if (sealGroup) {
      sealGroup.addEventListener('mouseenter', ()=> sealGroup.style.transform = 'translate(-50%,-50%) scale(1.1)');
      sealGroup.addEventListener('mouseleave', ()=> sealGroup.style.transform = 'translate(-50%,-50%)');
    }
  </script>
</body>
</html>
